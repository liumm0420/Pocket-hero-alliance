<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>修改</title>
    <script src="/jquery.js"></script>
    <link rel="stylesheet" href="/style.css">
</head>
<body>
        <form action="/xiugai" class="xiugai">
            名称 :  <input type="text" name="name" required value="<%= data.name%>"><br>
            价格 : <input type="text" name="price" value="<%= data. price %>" required > <br>
            描述 : <input type="text" name="describe" value="<%= data.describe %>" required> <br>
            图片       <input type="file" name="photo"> <br>
            击杀 : <input type="number" name="jisha" value="<%= data.nenglis[0] %>" required> <br>
            生存 : <input type="number" name="shengcun" value="<%= data.nenglis[1] %>" required> <br>
            助攻 : <input type="number" name="zhugong" value="<%= data.nenglis[2] %>" required> <br>
            物理 : <input type="number" name="wuli" value="<%= data.nenglis[3] %>" required> <br>
            魔法 : <input type="number" name="mofa" value="<%= data.nenglis[4] %>" required> <br>
            防御 : <input type="number" name="fangyu" value="<%= data.nenglis[5] %>" required> <br>
            <input type="hidden" name="time" value="<%=data.times %>">
                   <button type="submit"> 修改 </button>
        
        
        </form>
    
</body>
<script>
    $('.xiugai').submit(function (ev) {
        ev.preventDefault();
        // var data = $(this).serialize();
        // 创建一个表单的实例化对象, 包含表单中的所有数据,
        var data = new FormData(this);
        
        console.log(data);
        $.post({
            url: '/xiugai',
            data: data,
            contentType: false,   //编码类型,默认的编码类型urlencode,
            // 当设置为false时,发送请求以当前的编码类型为主
            processData: false, //默认情况下,数据发送至服务器时,会自动进行数据转换
            // 当设置为false时,会以当前的数据格式发送至服务器

            success: function (resData) {
                console.log(resData);
                if (resData.error == 1) {
                    alert(resData.message)
                    location.href = '/'
                } else {
                    alert('修改成功')
                    location.href = '/'
                }
            }
        })
    })
</script>
</html>